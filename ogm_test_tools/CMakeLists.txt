cmake_minimum_required(VERSION 3.10)
project(OGMTestProject)

# Set C++ standard and enforce debug mode by default if not specified
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Enable debugging symbols if the build type is not specified
if (CMAKE_BUILD_TYPE STREQUAL "")
    set(CMAKE_BUILD_TYPE Debug CACHE STRING "Build type: Debug, Release, etc." FORCE)
endif()

# Find dependencies
find_package(PCL REQUIRED)
find_package(Eigen3 REQUIRED)
find_package(Threads REQUIRED)

# Include directories
include_directories(
  ${OGM_INCLUDE_DIR}
  ${PCL_INCLUDE_DIRS}
  ${EIGEN3_INCLUDE_DIRS}
)

# Add the test executable and link necessary libraries
add_executable(ogm-test src/main.cpp)
target_link_libraries(ogm-test occupancy_grid_map_lib ${PCL_LIBRARIES} Eigen3::Eigen Threads::Threads)

# Add definitions and options for PCL
add_definitions(${PCL_DEFINITIONS})
link_directories(${PCL_LIBRARY_DIRS})

# Ensure debug symbols are generated by setting compiler flags for debug builds
if (CMAKE_BUILD_TYPE STREQUAL "Debug")
    target_compile_options(ogm-test PRIVATE -g)
endif()
